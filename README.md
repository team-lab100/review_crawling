**2024-03-19 업데이트**

사용방법
최초 git clone 시 yarn 명령어 실행

1. 스마트스토어 상품코드.xlsx 파일에 스마트스토어 상품코드 기재 ex) https://brand.naver.com/onnuristore/products/6626482241 일 경우 **6626482241** 기재 (한줄에 하나씩 여러개 가능)

2. hello.js 파일에서 checkoutMerchantNo 확인 후(온누리스토어 일 경우 변경할필요 없음) node hello.js 실행

3. 문제가 없다면 230908-500150359.csv 해당 파일에 반영됨

4. 크롤링완료 폴더 > 20231108_dcn 리뷰이관 요청.xlsx 파일에서 K열부터 P열까지 가져오고 크롤링한 파일 230908-500150359.csv에 붙여넣기

5. 스마트스토어 knowledgeShoppingMallProductId 의 매칭된 상품코드를 L 열 온누리스토어 상품코드 **(리뷰는 옵션단위라 꼭 옵션코드로 반영해야됨!)** 매칭

6. 매칭작업이 다 됬다면 N열을 복사 후 vscode같은 편집기 툴에 붙여넣기

7. 엑셀에 불필요한 정보가 같이 딸려와서 제거작업이 필요함
   1) "INSERT -> INSERT
   2) );" -> );
   3) "" -> " (이미지 파일에 쌍따옴표가 두개붙어서 하나로 파싱작업필요)

8. DB INSERT 후 잘 들어갔는지 확인

-----------------------------------------------------------------------------------

재관님에게 남기는 메모장

알아야 하는 keywords

row, column, list, json, fetch, body, nodejs

접근 순서

1. Xlsx 파일을 읽고 올바른 데이터 정렬. row(한 줄) 들을 리스트로 반환.

2. 반환된 리스트를 순서대로 하나씩 꺼내서 사용. 한 줄의 맨 앞 Column 이 상품 번호.

3. 상품 번호는 스스에서 검색에 사용되는 번호지만, 리뷰 검색에 사용되는 상품 번호는 그들만의 번호이다.

4. 따라서 상품번호로 스스상품번호를 얻어온다.

5. 얻어온 스스상품번호로 리뷰를 받아온다.

6. 리뷰들을 잘 정제하여 필요한 부부들만 챙겨 json 형태로 리스트에 차곡차곡 쌓는다.

7. json 형태 리스트를 csv 파일로 변환한다.

8. 필요한 확장자(.xlsx 등등)으로 직접 변환한다.


상황에 따라 바뀌어야 하는 것.

1. 읽을 파일 이름 바꿔주기.

2. 스스에서 onrikorea 인지, onnuri_store 인지 확인 후 바꿔주기.

3. Body 에 올바른 merchantNo 바꿔주기.

4. 마지막으로 생성될 파일 이름 바꿔주기.

파일 실행 명령어

node hello.js











